<!-- Include Flickity CSS -->
{{ 'flickity.css' | asset_url | stylesheet_tag }}
<!-- Include Flickity JavaScript -->
{{ 'flickity.pkgd.min.js' | asset_url | script_tag }}

<style>
  body { overflow-x: hidden; }

  .thumbnail-item {
    text-align: center;
    cursor: pointer;
  }
  .tcustomizer__image--big {
    width: 3em !important;
    height: 3em !important;
  }
  .product--information { height: fit-content; }

  .panel {
    padding: 0 2px;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.2s ease-out;
    border-bottom: solid 1px #f1f1f1;
  }
  h5.accordion-tab:after {
    content: "\002B";
    line-height: 13px;
    font-size: 35px;
    font-weight: 100;
    float: right;
    color: #4A5568;
    margin-right: 20px;
    transition: transform 0.5s;
    transform-origin: 50% 60%;
  }
  .active:after {
    transform: rotate(-225deg);
  }

  .variant-buttons {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-bottom: 1rem;
  }
  .variant-button {
    border: 1px solid #ccc;
    background: white;
    padding: 8px 16px;
    font-size: 14px;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
  }
  .variant-button:hover {
    border-color: #000;
  }
  .variant-button.active {
    background-color: black;
    color: white;
    border-color: black;
  }
</style>

{% assign selected_variant = product.selected_or_first_available_variant %}

<div class="product--information px-6 py-4">
  {% form 'product', product, id: 'product-form', novalidate: 'novalidate' %}
    <input type="hidden" name="id" id="variant-id" value="{{ selected_variant.id }}">

    <div class="mb-4">
      <span class="text-xs text-gray-500">{{ product.vendor }}</span>
      <h1 class="text-2xl font-body font-extralight text-gray-900">{{ product.title }}</h1>
      <div id="price-{{ section.id }}">
        {% if selected_variant.compare_at_price > selected_variant.price %}
          <span class="line-through text-base text-gray-500">{{ selected_variant.compare_at_price | money }}</span>
        {% endif %}
        <span class="text-sm text-gray-700">{{ selected_variant.price | money }}</span>
      </div>
    </div>

    {% if product.variants.size > 1 %}
      <div class="variant-options">
        <label class="block text-sm font-medium mb-2">Size</label>
        <div class="variant-buttons">
          {% assign variant_option_index = 0 %}
          {% for value in product.options_with_values[variant_option_index].values %}
            <button type="button" class="variant-button" data-value="{{ value }}">{{ value }}</button>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    <div class="mb-4">
      <label for="Quantity-{{ section.id }}">Quantity</label>
      <div class="flex border items-center">
        <button type="button" class="w-10 p-2" onclick="decrementQuantity()">{% render 'minus' %}</button>
        <input type="text" name="quantity" id="Quantity-{{ section.id }}" value="1" readonly class="text-center w-full p-2 text-xs text-gray-700">
        <button type="button" class="w-10 p-2" onclick="incrementQuantity()">{% render 'plus' %}</button>
      </div>
    </div>

    <button type="submit" name="add" class="bg-black text-white py-3 px-6 uppercase text-sm tracking-wide w-full">
      {% if selected_variant.available %}Add to Cart{% else %}Sold Out{% endif %}
    </button>
  {% endform %}

  <div class="accordion-div mt-6">
    <h5 class="accordion-tab font-body font-light uppercase text-gray-700 py-3">Description</h5>
    <div class="panel">
      <p class="text-sm text-gray-600 leading-6">{{ product.description }}</p>
    </div>
  </div>
</div>

<script>
  function incrementQuantity() {
    var input = document.getElementById('Quantity-{{ section.id }}');
    input.value = parseInt(input.value) + 1;
  }

  function decrementQuantity() {
    var input = document.getElementById('Quantity-{{ section.id }}');
    var newVal = parseInt(input.value) - 1;
    input.value = newVal < 1 ? 1 : newVal;
  }

  var acc = document.getElementsByClassName("accordion-tab");
  for (var i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var panel = this.nextElementSibling;
      if (panel.style.maxHeight) {
        panel.style.maxHeight = null;
      } else {
        panel.style.maxHeight = panel.scrollHeight + "px";
      }
    });
  }
</script>
