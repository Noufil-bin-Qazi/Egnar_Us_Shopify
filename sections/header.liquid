<style>
  .icon-white {
  color: #ffffff;
}
  [x-cloak] { display: none !important; }
</style>
<div class="bg-black bottom-1 sticky top-0 z-50 shadow-md" id="header" x-data="{ isOpen: false }">
  <div class="mx-auto">
    <div class="--header_desktop_upper lg:px-12 flex items-center justify-between py-5 border-b-[0.5px] border-gray-500">

      <!-- SOCIAL LINKS -->
      <div class="hidden md:flex justify-center md:justify-start gap-8">
        <a href="{{ settings.facebook_link }}"><i class="icon-white">{% render 'facebook' %}</i></a>
        <a href="{{ settings.twitter_link }}"><i class="icon-white">{% render 'twitter' %}</i></a>
        <a href="{{ settings.instagram_link }}"><i class="icon-white">{% render 'instagram' %}</i></a>
        <a href="{{ settings.youtube_link }}"><i class="icon-white">{% render 'youtube' %}</i></a>
        <a href="{{ settings.tiktok_link }}"><i class="icon-white">{% render 'tiktok' %}</i></a>
        <a href="{{ settings.linkedin_link }}"><i class="icon-white">{% render 'linkedin' %}</i></a>
      </div>

      <!-- STORE NAME / STORE LOGO -->
      <div class="flex-grow flex items-center justify-center lg:flex-1 truncate">
        {% assign header_image = section.settings.header_image %}
        {% if header_image != blank %}
        <img width="85" height="30" src="{{ section.settings.header_image | img_url: 'master' }}" alt="Header Image">
        {% else %}
        <h1 class="text-xl text-white uppercase font-bold font-body truncate">{{ shop.name }}</h1>
        {% endif %}
      </div>

      <!-- CART LOGIN REGISTER LINKS -->
      <div x-data="{ isCartOpen: false }" class="hidden md:flex items-center">
    <!-- Cart link -->
    <a href="#" @click="isCartOpen = !isCartOpen" class="px-5 font-body font-extralight whitespace-nowrap text-base text-white hover:opacity-90">
        Cart
    </a>
    <!-- Cart drawer content -->
    <div x-show="isCartOpen" @click.away="isCartOpen = false" class="fixed inset-0 overflow-hidden z-50" x-cloak>
        <!-- Background overlay -->
        <div class="absolute inset-0 bg-[#363636] opacity-70 transition-opacity ease-linear duration-50" x-show.transition.opacity.duration.50ms="isCartOpen"></div>
        <!-- Cart drawer -->
        <div class="absolute inset-y-0 right-0 max-w-[400px] w-full bg-white shadow-lg h-full transform transition-transform duration-500 ease-in-out"
             x-show.transition.duration.50ms="isCartOpen"
             x-transition:enter="transition ease-out duration-500"
             x-transition:enter-start="translate-x-full"
             x-transition:enter-end="translate-x-0"
             x-transition:leave="transition ease-in duration-500"
             x-transition:leave-start="translate-x-0"
             x-transition:leave-end="translate-x-full">
            <!-- Drawer title and close button -->
            <div class="--Drawertitle flex flex-row justify-between p-7 border-b sticky top-0">
                <h2 class="text-xl text-center font-body font-extralight"> Cart</h2>
                <div @click="isCartOpen = false" class="overflow-hidden focus:outline-none">{% render 'icon-close' %}</div>
            </div>
            <!-- Cart items -->
            {% if cart.item_count > 0 %}
             <div class="max-h-full h-full overflow-y-auto">
            <form id="cartForm" class="" action="{{ routes.cart_url }}" method="POST" novalidate>
                {% for item in cart.items %}
                <div class="py-2">
                    <!-- Your cart item details -->
                    <div class="--productimg p-7 flex flex-row">
                        {% if item.image %}
                        <img src="{{ item.image | img_url: 'master' }}" alt="{{ item.title | escape }}" class="w-32 h-32 object-cover">
                        {% else %}
                        {{ 'product-1' | placeholder_svg_tag: 'w-32 h-32 object-cover border' }}
                        {% endif %}
                        <div class="--productdetails flex flex-col">
                            <div class="flex flex-col pl-6">
                                <a href="{{ item.url }}" class="my-1 text-xs font-body font-extralight">{{ item.product.title | truncatewords: 4 }}</a>
                                <span class="text-xs font-body font-extralight text-gray-500 my-1">{{ item.variant.title }}</span>
                                <span class="text-xs font-body font-extralight">{{ item.line_price | money }}</span>
                            </div>
                            <div class="--cartwidgets flex flex-row pl-6 gap-6">
                                <div class="flex flex-row mt-2">
                                    <!-- Minus button -->
                                    <a href="#" onclick="updateQuantity({{ forloop.index }}, 'minus')" class="w-8 border border-r-0 py-1 px-2 items-center justify-center">{% render 'minus' %}</a>
                                    <!-- Quantity input field -->
                                    <input type="text" name="updates[]" value="{{ item.quantity }}" min="1" id="updates_{{ forloop.index }}" class="w-8 border border-l-0 border-r-0 px-1 text-xs font-body font-extralight text-gray-500 text-center" readonly>
                                    <!-- Plus button -->
                                    <a href="#" onclick="updateQuantity({{ forloop.index }}, 'plus')" class="w-8 py-1 px-2 border border-l-0 items-center justify-center">{% render 'plus' %}</a>
                                </div>
                                <a href="#" class="remove-item pt-3 underline text-start text-xs font-extralight font-body text-red-500 my-1" data-line="{{ forloop.index }}">remove</a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
                <!-- Cart footer -->
                <div class="--drawerfooter bg-white w-full py-6 px-7 border-t sticky bottom-20">
                    <!-- Total price -->
                    <h3 class="text-sm text-right text-gray-500 font-body font-extralight" id="displayed_price">Total: {{ cart.total_price | money }}</h3>
                    <!-- Shipping & taxes info -->
                    <div class="my-3">
                        <h3 class="mb-2 text-xs text-right text-gray-500 font-body font-extralight">Shipping & taxes calculated at checkout</h3>
                    </div>
                    <!-- Checkout button -->
                    <div class="my-2">
                        <button type="submit" name="checkout" class="w-full p-3 border border-gray-800 tracking-[.2rem] uppercase font-body font-extralight text-sm bg-gray-800 hover:bg-gray-900 text-white">Checkout</button>
                    </div>
                </div>
            </form>
            </div>
            {% else %}
            <!-- Empty cart message -->
            <p class="px-24 py-60 text-sm font-body font-extralight">Your cart is currently empty.</p>
            {% endif %}
        </div>
    </div>
    <!-- Login and search links -->
    <a href="{{ routes.account_login_url }}" class="px-5 font-body font-extralight text-base text-white hover:opacity-90">Login</a>
    <a href="#" @click.prevent="isOpen = !isOpen" class="pl-5 font-body font-extralight text-base text-white hover:opacity-90">Search</a>
    <!-- Search box content -->
    <div x-show="isOpen" @click.away="isOpen = false"
         x-transition:enter="transition ease-out duration-200 transform"
         x-transition:enter-start="opacity-0 translate-y-[-10px]"
         x-transition:enter-end="opacity-100 translate-y-0"
         x-transition:leave="transition ease-in duration-150 transform"
         x-transition:leave-start="opacity-100 translate-y-0"
         x-transition:leave-end="opacity-0 translate-y-[-10px]"
         class="flex flex-row absolute top-full right-0 px-10 bg-white border border-gray-300 rounded shadow-lg p-2 w-full" x-cloak>
        <!-- Search box -->
        
        <div class="overflow-hidden">{% render 'icon-search' %}</div>
        <form action="{{ routes.search_url }}" class="w-full">
          <input type="text" placeholder="Search..." name="q" class="w-full px-6 py-3 rounded text-medium font-body font-extralight focus:outline-none focus:border-black">
        </form>  
        <div @click="isOpen = false" class="overflow-hidden">{% render 'icon-close' %}</div>
    </div>
</div>

    </div>
     
    <!-- Header Desktop lower-->
    <div class="--header_desktop_lower flex items-center justify-center mx-auto border-gray-500 border-b-[0.5px]">
      
      <!-- NAVIGATION MENU -->
      <nav  class="hidden md:flex space-x-10">
        {% for link in linklists.main-menu.links %}
          {% if link.links !=blank %}
            <div class="relative" x-data="{ open: false }">
              
             <button 
               @mouseenter="open = true"
               @mouseleave="open = false"
               type="button" 
               class="inline-flex font-body font-extralight uppercase text-sm text-white hover:opacity-90 border-0 border-white hover:border-b-2 py-3"
              >
              {{ link.title }}
              </button>

               <!-- Dropdown Content -->

              <div x-show="open" 
              @mouseenter="open = true" 
              @mouseleave="open = false" 
              @click.away="open = false" 
              class="absolute z-10 transform px-2 w-screen sm:px-0 lg:ml-0 md:-translate-x-[875px] border-gray-500 border-t-[0.5px]" 
              x-cloak>
              
              <div class="shadow-lg  ring-black ring-opacity-5 overflow-hidden bg-black">
                <div class="relative grid grid-cols-5 w-fit flex-col gap-20 py-2">
                  {% for childlink in link.links %}
                   <div class="--Megamenuinner w-fit mx-10 my-5">
                      <a href="{{ childlink.url }}" class="w-full font-body uppercase font-normal text-white text-sm items-start">  
                         {{ childlink.title }}
                      </a>
                       {% if childlink.links != blank %}
                        <div class="--Megamenusubitem mt-4 flex flex-col">
                          {% for grandchildlink in childlink.links %}
                            <a href="{{ grandchildlink.url }}" class="w-full p-0.5 font-body uppercase font-extralight text-gray-300 text-sm items-start hover:opacity-60">
                             {{ grandchildlink.title }}
                            </a>
                          {% endfor %}

                        </div>
                        {% endif %}
                    </div> 
                  {% endfor %}
                  


                </div>
              </div>
              </div>

            </div>
          {% else %}
            <div class="relative">
          <a href="{{ link.url }}" class="font-body font-extralight text-sm uppercase text-white hover:opacity-80">
            <h1 class="py-3">{{ link.title }}</h1>
            </a>
          </div>  
          {% endif %}
          
        {% endfor %}
        
      </nav>
    </div>

  </div>

  

</div>

<script src="https://cdn.jsdelivr.net/npm/alpinejs@2.8.2/dist/alpine.min.js" defer></script>
<!-- JavaScript function to update quantity -->
<script>
  function updateQuantity(index, action) {
    var input = document.getElementById('updates_' + index);
    var currentQuantity = parseInt(input.value);
    var newQuantity;

    if (action === 'plus') {
      newQuantity = currentQuantity + 1;
    } else if (action === 'minus') {
      newQuantity = Math.max(1, currentQuantity - 1); // Ensure quantity doesn't go below 1
    }

    input.value = newQuantity;

    
  }

  
</script>
<!-- jQuery script to update cart drawer items -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
   $(document).ready(function() {
    // Attach click event listener to remove item links
    $('.remove-item').click(function(e) {
        e.preventDefault(); // Prevent default link behavior
        var line = $(this).data('line');
        var removeUrl = "{{ routes.cart_change_url }}?line=" + line + "&quantity=0";
        
        // Hide the product item immediately
        $(this).closest('.py-2').hide();

        // Make AJAX request to remove item
        $.ajax({
            url: removeUrl,
            type: 'POST',
            dataType: 'json',
            success: function(data) {
                // Handle successful response (e.g., update UI, display success message)
                console.log('Item removed successfully:', data);
                // Optionally, update total price and other UI elements
                
                // If the cart is empty, display a message
                if ($('.py-2').length == 0) {
                    $('.empty-cart-message').show();
                    $('.cart-footer').hide();
                }
            },
            error: function(xhr, status, error) {
                // Handle error (e.g., display error message)
                console.error('Error removing item:', error);
                // If there's an error, show the product item again
                $(this).closest('.py-2').show();
            }
        });
    });
});

    
</script>


{% schema %}
  {
    "name": "Header",
    "settings": [
      {
      "type": "image_picker",
      "id": "header_image",
      "label": "Header Image"
      },
      {
        "type": "text",
        "id": "facebook_link",
        "label": "Facebook Link",
        "default": "#"
      },
      {
        "type": "text",
        "id": "twitter_link",
        "label": "Twitter Link",
        "default": "#"
      },
      {
        "type": "text",
        "id": "instagram_link",
        "label": "Instagram Link",
        "default": "#"
      },
      {
        "type": "text",
        "id": "youtube_link",
        "label": "Youtube Link",
        "default": "#"
      },
      {
        "type": "text",
        "id": "tiktok_link",
        "label": "TikTok Link",
        "default": "#"
      },
      {
        "type": "text",
        "id": "linkedin_link",
        "label": "LinkedIn Link",
        "default": "#"
      }
    ]
  }
  {% endschema %}
  